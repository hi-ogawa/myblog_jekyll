---
layout: post
title: "Jekyll Setup"
description: ""
category: 
tags: [jekyll, ruby]
---

### blog setup with jekyll bootstrap

- References
  - <http://jekyllrb.com/docs/home/>
  - <http://jekyllbootstrap.com/usage/jekyll-quick-start.html>
- remove ad or some other bullshits
  - just commend out `comment:` in _config.yml
- configuration `index.html`, `about.html`
- elisp shortcut to put highlight: [My Elisp Tweak]({% post_url 2015-07-21-my-elisp-tweak %})
- move between `http://localhost:4000/2015/07/21/to-do/` and `_posts/2015-07-21-to-do.md`
  - see this post: [Applescript with Javascript]({% post_url 2015-07-22-applescript %})
- search function throughout my posts
  - <http://thornelabs.net/2014/05/12/instant-search-with-twitter-bootstrap-jekyll-json-and-jquery.html>
  - <https://truongtx.me/2012/12/28/jekyll-create-simple-search-box/>
- table of contents auto-generation
  - <https://github.com/dafi/jekyll-toc-generator>
  - <https://github.com/dafi/tocmd-generator>
- consider a good practice to take a note about tips instead of 'mydoc/tips.org'
  - ex. overwriting css style: give a link to source code of phonecat sample.
- how to manage To-do in this blog
- make the width of all pages smaller
- not only jump to header, but also anything

### Misc

- access post yaml front matter: `site.posts[0].data`
- access site configuration in _config.yml: `site.config`
- check if draft mode (jekyll build/serve --drafts): `site.show_drafts`

### Markdown-mode in Emacs

- C-c C-n: go to next visible header
- C-c C-p: go to previous visible header
- see [this post]({% post_url 2015-07-21-my-elisp-tweak %})

- make todo work cycler

### Move from Emacs to Chrome

Not just run a command `open <file.html>`

- ? open chrome from command line `/Applications/Google\ Chrome.app/Contents/MacOS/Google\ Chrome`
  - ? <http://peter.sh/experiments/chromium-command-line-switches/>
  - ?<https://www.chromium.org/for-testers/command-line-flags>

- applescript
  - only if the page of active tab is same as requested opening file,
	invoke jump to another anchor.
  - questions:
	- how to run from shell?
	- how to give arguments?
	- osascript <https://developer.apple.com/library/mac/documentation/Darwin/Reference/ManPages/man1/osascript.1.html>


- assume jekyll build already ran, then use some tmp files generated by custom generator
  - 1 generate a file which associates filename with published url
  - some shortcut in emacs invokes things as follow:
	- lookup the tmp file
	- read file -> process as json -> shellcommand node -> find the url and anchor id
	- then how to move to an existing tab ?
	  - chrome from command line
	  - or, applescript
- elisp
  - current line number:
	- `(what-line)` <https://www.gnu.org/software/emacs/manual/html_node/eintr/what_002dline.html>
	- `(number-to-string (line-number-at-pos))`
	  - <http://www.gnu.org/software/emacs/manual/html_node/elisp/String-Conversion.html>
	  - <http://www.gnu.org/software/emacs/manual/html_node/elisp/Text-Lines.html>
  - read file
	- <http://ergoemacs.org/emacs/elisp_read_file_content.html>
	- <https://lists.gnu.org/archive/html/help-gnu-emacs/2004-09/msg00292.html>
  - parse json
	- <http://edward.oconnor.cx/2006/03/json.el>
	- association list <http://www.gnu.org/software/emacs/manual/html_node/elisp/Association-Lists.html#Association-Lists>
	- map <http://www.gnu.org/software/emacs/manual/html_node/elisp/Mapping-Functions.html>
	- nth <http://www.gnu.org/software/emacs/manual/html_node/elisp/List-Elements.html>
	- membership <http://ergoemacs.org/emacs_manual/elisp/Sets-And-Lists.html>
	- filter <http://ergoemacs.org/emacs/elisp_filter_list.html>
	- cl-lib <http://www.gnu.org/software/emacs/manual/html_mono/cl.html>
	         <http://emacswiki.org/emacs/CommonLispForEmacs>
	- cl-sort <http://www.gnu.org/software/emacs/manual/html_mono/cl.html#Sorting-Sequences>
  - check type
	- <http://www.gnu.org/software/emacs/manual/html_node/elisp/Type-Predicates.html>
  - make symbol from string
	- <http://www.gnu.org/software/emacs/manual/html_node/elisp/Creating-Symbols.html#Creating-Symbols>
- curl command  <http://stackoverflow.com/questions/18204326/how-to-post-url-in-data-of-a-curl-request>
  - how to set not to verbose

- read file in nodejs <http://stackoverflow.com/questions/10011011/using-node-js-how-do-i-read-a-json-object-into-server-memory>
- filter with underscore utility

### Move from Chrome to Emacs

- related files
  - `assets/my_ext/browser_to_emacs.coffee`
  - node project
  - `_plugins/generator_test.rb`
	- how to make an anchor id correctly as done by jekyll
	- read source: redcarpet(rndr_header_anchor): <https://github.com/vmg/redcarpet/blob/4e640dd471c08df350373a79327302f1add19d00/ext/redcarpet/html.c#L283>
	- or just import library and run that

- TODO
  - ? local check mode and publish mode 
  - gather ruby library which i used
	- index <http://stackoverflow.com/questions/6242311/quickly-get-index-of-array-element-in-ruby>
	- map(&:), each_line, chomp <http://stackoverflow.com/questions/601888/how-do-you-loop-through-a-multiline-string-in-ruby>
    - select (filter function) <http://progzoo.net/wiki/Ruby:Filtering_an_Array>
	- how to give higher order argument
	  - not `p = site.posts.select({|p| p.title == 'Jekyll Setup'}).first`
	  - but `p = site.posts.select{|p| p.title == 'Jekyll Setup'}.first`
	- json print <http://stackoverflow.com/questions/5507512/write-to-json-file-in-correct-format-ruby>
	- write to file <http://stackoverflow.com/questions/2777802/how-to-write-to-file-in-ruby>
	- downcase <http://stackoverflow.com/questions/1020568/how-to-convert-a-string-to-lower-or-upper-case-in-ruby>
	- regular expression <http://www.tutorialspoint.com/ruby/ruby_regular_expressions.htm>
  - âœ“ when reading _checkmark_ generator_test.rb throws error `invalid byte sequence in US-ASCII`
	- <http://stackoverflow.com/questions/5163339/write-and-read-a-file-with-utf-8-encoding>
	- <http://stackoverflow.com/questions/11664403/does-ruby-provide-a-way-to-do-file-read-with-specified-encoding>
  - jekyll generator <http://jekyllrb.com/docs/plugins/#generators>
  - not apply `emacs-jump` attributes when it's in syntax highlight mode

- Open server process locally, which monitors a request, like localhost:4010.
- When click happens on a header in a jekyll post, that triggers a javascript function,
  which send a request to localhost:4010 with data consisting of
  the id attribute of the header
- Then, after the server calculates the location of a header in the original markdown file,
  it runs a command `emacsclient` with a line number.
- To realize this, I have to find a way to put Javascript code in jekyll posts.
  - put `<script src="/assets/my_ext/browser_to_emacs.js"></script>` around the bottom of
	`_includes/themes/bootstrap-3/default.html` after including jQuery.
  - put the below code in `assets/my_ext/browser_to_emacs.js`
	(this is an original coffeescript):
- What server to use? I want to try node.js.

### how to get syntax highlight work in jekyll

- Basically, Jekyll Bootstrap has a scss file `_sass/_syntax-highlighting.scss` for highlighing code snippet.
- The scss file are included in `css/main.css`, like this:
{% highlight css %}
@import
        "base",
        "layout",
        "syntax-highlighting"
;
{% endhighlight %}
- And Jekyll always compiles `css/main.css` into `_site/css/main.css`.
- But, by default Jekyll Bootstrap employs a customized styles file like this:
{% highlight html %}
// in _includes/themes/bootstrap-3/default.html
<!-- Custom styles -->
<link href="{{ ASSET_PATH }}/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">
{% endhighlight %}
- So, all you have to do is just comment out that style link and put this code:
{% highlight html %}
<link href="/css/main.css" rel="stylesheet">
{% endhighlight %}

### Taking `tag_box` style from jekyll-bootstrap

{% highlight sass %}
/* copied from `assets/themes/bootstrap-3/css/style.css` to `_sass/_tag-box.sass`
.tag_box
  list-style: none
  margin: 0
  overflow: hidden

  li
    line-height: 28px
    float: left

    i
      opacity: 0.9

  a
    padding: 3px 6px
    margin: 2px
    background: #eee
    color: #555
    border-radius: 3px
    text-decoration: none
    border: 1px dashed #cccccc

    span
      vertical-align: super
      font-size: 0.8em

    &:hover
      background-color: #e5e5e5

    &.active
      background: #57A957
      border: 1px solid #4c964d
      color: #FFF
{% endhighlight %}

### Short language names for highlight tag

<http://haisum.github.io/2014/11/07/jekyll-pygments-supported-highlighters/>


### Write My Own Jekyll Tag

By following [this page](http://jekyllrb.com/docs/plugins/#tags), I made
one basic tag plugin which generates anchor link.

{% highlight ruby %}
 # _plugins/test.rb
module Jekyll
  class MyAnchorTag < Liquid::Tag

    def initialize(tag_name, text, tokens)
      super
      @text = text
    end

    def render(context)
      "#{@text.strip}<a name=\"#{@text.strip}\"></a>"
    end
  end
end

Liquid::Template.register_tag('anchor', Jekyll::MyAnchorTag)
{% endhighlight %}
